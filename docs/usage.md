# 使用指南
以下命令中，`/`表示等价的命令名称，`[ ]`表示简写的参数形式，`|`表示不同的参数选择，请务必注意参数与命令之间需要`空格`间隔，扫雷联萌简称为`联萌`，中国扫雷网简称为`雷网`。请务必注意，使用指南不是开发指南，其中只包含对触发语法的简要介绍，不包含对函数与设计思路的详细说明。

## 帮助
+ 显示此指南网址。

```
    # 显示本网址
    guide/指南
    # 显示项目github地址
    backupguide/备用链接
```

+ 显示联萌安装包下载地址

```
    getpackage/安装包/安装链接
```

+ 显示扫雷指南

```
    msguide/扫雷指南
```

> 祝早日达到目标升仙成圣\~

## 群管理员权限
+ 启动机器人。

```
    enable/启动/启动机器人
```

+ 关闭机器人。

```
    disable/关闭/关闭机器人
```

> 群管理员无法控制机器人关联联萌账户的登录与登出。 机器人不会因为重复的启动/关闭而重置全局变量。

> 机器人将与每天11:00:00与23:00:00自动获取群员信息。同时每次执行`enable`命令时，机器人也会主动获取群员信息。即使群员退群，其信息也会保留。

+ 设置复读屏蔽词。

```
    block 屏蔽词汇
    unblock 待移除的屏蔽词汇
```

> 屏蔽词汇仅用在机器人复读时生效，其功能为: 语句中含有屏蔽词，则机器人不会复读。

> **不推荐**设置过多的屏蔽词，可能会导致性能问题。

## 雷网相关
+ 交给小爆了，小鱼不负责查询雷网了~

## 娱乐功能
+ 打招呼功能: 根据当前的时间，机器人会给出不同的问候语句。

```
    greet/小鱼
```

> 戳一戳小鱼，也会给出与打招呼相同的反馈。

+ 膜佬功能：包含了多样的膜佬形式(包括动图)和随机的膜佬语句。

```
    # 空泛膜拜
    praise/膜/膜拜

    # 用于复读的空泛膜拜(会连续膜两次)         
    admire/狂膜

    # 定向膜拜            
    praise/膜/膜拜 大佬的名字

    # 用于复读的定向膜拜(会连续膜两次)  
    admire/狂膜 大佬的名字
```

> 用于复读的膜佬语句**不会**出现动图。

+ 加油功能：包含了少量的加油形式和随机的加油语句。
```
    # 空泛加油
    cheer/加油

    # 定向加油         
    cheer/加油 大佬的名字
```

+ (增量)复读功能：如果群内有五条呈**等差数列**的消息(不包含机器人在内)，机器人会复读等差数列的下一项，相同的消息**只会**复读一次。

> (增量)复读功能有5%的概率被机器人强行打断，此时会重置相应的复读计数器。

> (增量)复读功能有15%的概率被机器人随机倒装句子中的某一部分，此时不会重置相应的复读计数器，该功能不会影响增量复读的字段，且在**句子中含有非表情的文字**时才会触发。

> 目前支持复读图片，但是机器人仅会复读一个消息中的图片内容，并**忽略**其中的文字内容，且复读图片的优先级**高于**其它内容。

+ 机器人打架功能：需要小爆也在群内，且自行设置好**能够构成循环的**`触发语句`，每天00:00:00与12:00:00重置次数，打架重复迭代上限为5次，每次打架会有10%的概率自动终止。

```
    conflict/打架/{触发语句}
```

+ 小黑屋功能：在机器人为管理员时，禁言进入小黑屋的用户一段时间。

```
    # 进入自定义时间段的小黑屋
    enterroom/进入小黑屋 时间(以分钟为单位)
    # 进入随机时间段的小黑屋
    enterroom/进入小黑屋
```

+ 随机数功能: 生成可重复/不可重复的随机数。

```
    # 生成 [m, n] 之间的c个随机整数，不重复
    randi/随机数 m n c
    # 生成 [m, n] 之间的c个随机整数，可重复
    randi/随机数 m n c r
    # 生成 [m, n] 之间的c个随机整数，升序排列
    randi/随机数 m n c a
    # 生成 [m, n] 之间的c个随机整数，降序排列
    randi/随机数 m n c d
```

> 最多生成10个随机数，最少生成一个，如果参数`c`超出范围，将只生成一个随机数，所有附加参数可以叠加使用，升序排列优先级高于降序排列。

> 随机数生成采用`Python`自带的`random.sample`，不保证效率，数据范围充分大。

### 42点
+ 算42点小游戏：每日8-23:42:42自动触发，广播至**所有**机器人加入的群中。

```
    # 答题
    calc42/42点

    # 规则              
    calc42help/42点规则/42点说明 

    # 等价解说明
    calc42equal/42点等价解/等价解说明

    # 当前问题
    current42/当前42点/当前问题

    # 得分说明
    calc42score/42点得分说明

    # 得分
    score42/42点积分/42点得分

    # 得分排行榜
    ranking42/42点排名/42点排行/42点排行榜
```

+ 42点游戏规则(暂定): 
    - 每日某些小时的42分42秒, 会给出5个位于0至13之间的整数，玩家需要将这五个整数(可以调换顺序)通过四则运算与括号相连，使得结果等于42;
    - 回答时以"calc42"或"42点"开头，加入空格，并给出算式;
    - 将根据每个问题解的个数决定结算时间，5个解对应3分钟的结算时间，15分钟封顶;
    - 游戏频率: 8-23时中每`GAME_FREQUENCY`小时进行一次游戏.
    - 示例：(问题) 1 3 3 8 2，(正确的回答) calc42/42点 (1 + 3 + 3) * (8 - 2)，(错误的回答) calc422^8!3&3=1.

+ 关于等价解的说明: 
    - 四则运算的性质得出的等价是等价解;
    - 中间结果出现0，可以利用加减移动到式子的任何地方;
    - 中间结果出现1，可以利用乘除移动到式子的任何地方;
    - 等值子式的交换等价;
    - 2\*2与2+2; 4/2与4-2等价;
    - a+b=c时，1/1型的等价.

+ 关于得分的说明:
    - 每题的得分由"当前总时间/总限时(记为m)"和"当前解数/总解数(记为n)"共同决定，得分的计算公式为[10\*n^(2-m)]+5-5\*[m];
    - 如果题目被完全求解(AK)，求解该题目全员额外加10分;
    - 首杀玩家额外加5分，最后一个解玩家额外加[10\*n^(2-m)\*(1-1/(总解数))]分;
    - 如果题目多于一半的解均被某名玩家求出，该名玩家额外加(该玩家给出的解数)分;
    - 积分会根据游戏频率进行相应加倍;
    - 显示积分时会进行归一化.

> 42点游戏的核心部分已经分离该项目，转为独立开发状态。 项目及相关使用详见[这里](https://pypi.org/project/42Points/)。

> `GAME_FREQUENCY`代表游戏频率，其值表示小时/局。

## 今日之星查询
+ 主动查询联萌每日一星。

```
    dailystar/今日之星/联萌每日一星
```

+ 主动查询联萌每日一星次数。

```
    dailystarcount/联萌每日一星次数 用户ID
```

+ 自动推送联萌每日一星：于每天00:01:30进行推送，误差为30秒，该功能自动触发，广播至**所有**机器人加入的群中。

## 每日一图查询
+ 主动查询每日一图：图的`大小`，`bv`，`op`，`is`与`第一名成绩`。

```
    dailymap/每日一图
```

+ 自动推送每日一图：每天00:03:00进行推送，误差为30秒，该功能自动触发，广播至**所有**机器人加入的群中。

> 如果每日一图尚未完成，`第一名成绩`会显示为 `inf`。

## 用户信息查询
+ 按ID搜索联萌用户：获得用户的`时间记录(含排名)`，`bvs记录(含排名)`，`游戏局数(含开率)`，`当前等级`与`当前排名`。

```
    id/联萌 用户ID
```

+ 按昵称模糊搜索联萌用户：获得用户的`昵称`与`ID`。

```
    search/查询昵称 用户昵称
```

+ 排名比较功能：比较两个ID的排名。

```
    battle/对战 ID1 ID2
```

+ 个人信息查询：本功能需要群主给以查询用户ID命名的头衔，查询结果与上文一致。

```
    personinfo/个人信息/个人成绩
```

> 如果使用`search %`命令，将模糊搜索前十玩家. 模糊搜索最多查询`10`名玩家。

> 由于该功能容易刷屏，每个联萌ID**一个小时以内**仅能查询一次，多次查询时机器人不会回应。

## 排名查询
+ 主动获取联萌每个等级的人数与总计人数, 并比较与上周的人数变化。

```
    level
```

+ 自动推送联萌每个等级的人数与总计人数：每周一00:00:00进行推送，误差为30秒，该功能自动触发，广播至**所有**机器人加入的群中。

+ 经典模式排行榜查询：包含用户的`排名`，`昵称`，`ID`与`成绩`。

```
    # 用于查询时间榜前10名
    rank/ranking/排名 

    # 用于查询时间榜起始排名至终止排名
    rank/ranking/排名 [t]ime/时间|[b]vs/3bvs 起始排名 终止排名 

    # 所有参数
    rank/ranking/排名 [t]ime/时间|[b]vs/3bvs 起始排名 终止排名 [a]ll/全部|[n]f/盲扫|[f]l/标旗 [a]ll/全部|[i]nt/初级|[b]eg/中级|[e]xp/高级 
```

> 为防止刷屏，最大查询范围为 20 名用户。

+ 各种其它的娱乐模式排行榜查询：包含用户的`排名`，`昵称`，`ID`与`成绩`。

```
    # 无尽排行榜
    rank/ranking/排名 [e]ndless/无尽

    # 无猜排行榜(目前暂时不开放)
    rank/ranking/排名 [n]onguessing/无猜 

    # 雷币排行榜
    rank/ranking/排名 c[o]in/coins/财富

    # 乱斗排行榜
    rank/ranking/排名 [c]haos/乱斗 

    # 进步排行榜    
    rank/ranking/排名 [a]dvance/进步

    # 人气排行榜
    rank/ranking/排名 [v]isit/人气    
```

> 娱乐功能的排行榜仅支持查询对应排行榜前 10 名用户，后面设定的参数会被直接忽略。

## 录像解析

+ 录像数据解析功能：包含雷图的信息以及用户的操作信息，基本与电脑端`arbiter`的计数器的统计信息保持一致。

```
    # 根据[录像ID]解析
    analyze/分析 [r]ecord/录像 录像ID 

    # 根据[发帖ID]解析          
    analyze/分析 [p]ost/帖子   帖子ID           
```

> 详细的统计信息包含：time/est，solved_bv/bv/bvs，ce/ces，cl/cls，l/fl/r/d，path，op/is，ioe/iome，qg/rqp，corr/thrp，stnb，此外还包含该局的扫雷结果图。

+ 分享录像链接自动解析功能：该功能在提取到`http://tapsss.com`与`post=`关键词后自动触发。

+ 自动膜佬功能：该功能在在提取到`http://tapsss.com`，`post=`，`恭喜`，`刷新`与`记录`关键词后自动触发，包含录像解析功能，如果刷新了时间记录，会显示用户的当前排名。

> 由于自动推送的访问流量过于庞大，本机器人暂未设置自动推送的功能，自动膜佬功能需要结合群中的**自动推送机器人**一起使用。

## 对战机器人

> 由于联萌的访问限制，对战机器人被分成了另外的一个项目，项目地址请点击[这里](https://github.com/T0nyX1ang/mswar-bot-autopvp)。对战机器人和本项目的机器人是不同的项目，请务必加以区分。

+ 查询对战机器人状态：包含的`对战等级(含当前等级完成度)`，`胜负场数(含胜率)`，与`最近一盘战况`。

```
    autopvp/对战机器人
```

+ 自动推送对战机器人状态：每天00:00:00进行推送，误差为30秒，该功能自动触发，广播至**所有**机器人加入的群中。

> 如果最近一盘对战机器人被打败，本机器人会**自动**膜拜战胜对战机器人的玩家。

## 机器人为管理员的额外功能

> 请注意，以下功能需要保证机器人为管理员，在权限不足时不会触发，或者触发无需提权的分支指令。

+ 小黑屋。

+ 解析加群申请，将加群用户联萌ID信息公开。

+ 欢迎新人。

+ 退群告别。